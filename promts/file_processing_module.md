# МОДУЛЬ: ОБРАБОТКА ФАЙЛОВ - ДЕТАЛЬНАЯ ИНФОРМАЦИЯ

**Команда для получения:** `get_file_processing_help`

## ДОСТУПНЫЕ ПАПКИ В СИСТЕМЕ

### Основные директории:
- **Audio/** — аудиофайлы (MP3, WAV, OGG, FLAC, M4A, AAC, WMA)
- **Photos/** — изображения (JPG, PNG, GIF, BMP, WEBP) + OCR
- **Video/** — видеофайлы (MP4, AVI, MKV, MOV, WMV, FLV, WEBM) + анализ кадров
- **Excel/** — таблицы Excel (XLSX, XLS, CSV)
- **Docx/** — документы Word (DOCX, DOC, TXT, MD, RTF, JSON, XML, HTML)
- **PDF/** — PDF документы
- **output/** — создаваемые файлы

### Базовая директория:
- **Desktop**: C:\\Users\\vital\\Desktop

## ОСНОВНЫЕ ДЕЙСТВИЯ

### 1. ПРОСМОТР СОДЕРЖИМОГО ПАПКИ
```json
{
  "action": "list_files",
  "folder": "Photos",
  "description": "Просматриваю содержимое папки с изображениями"
}
```

### 2. ОБРАБОТКА ДОКУМЕНТОВ
```json
{
  "action": "process_document",
  "file_path": "document.docx",
  "description": "Обрабатываю DOCX документ"
}
```

### 3. СОЗДАНИЕ ФАЙЛОВ
```json
{
  "action": "generate_file",
  "content": "Содержимое файла...",
  "filename": "report.docx",
  "file_type": "docx",
  "description": "Создаю отчёт в формате DOCX"
}
```

### 4. ИЗВЛЕЧЕНИЕ ТЕКСТА (OCR)
```json
{
  "action": "extract_text",
  "image_path": "document.jpg",
  "force_ocr": true,
  "description": "Извлекаю текст с изображения документа"
}
```

### 5. АНАЛИЗ ИЗОБРАЖЕНИЙ
```json
{
  "action": "analyze_image",
  "image_path": "photo.jpg",
  "check_for_text": true,
  "description": "Анализирую изображение и проверяю наличие текста"
}
```

## ПОДДЕРЖИВАЕМЫЕ ФОРМАТЫ

### Документы:
- **DOCX, DOC** — Microsoft Word документы
- **TXT** — простые текстовые файлы
- **MD** — Markdown файлы
- **RTF** — Rich Text Format
- **JSON** — JSON данные
- **XML** — XML документы  
- **HTML** — HTML страницы

### Таблицы:
- **XLSX, XLS** — Microsoft Excel
- **CSV** — таблицы с разделителями

### PDF:
- **PDF** — Adobe PDF документы

### Изображения:
- **JPG, JPEG** — JPEG изображения
- **PNG** — PNG изображения  
- **GIF** — GIF анимации
- **BMP** — Bitmap изображения
- **WEBP** — WebP формат

### Видео:
- **MP4** — MPEG-4 видео
- **AVI** — AVI контейнер
- **MKV** — Matroska видео
- **MOV** — QuickTime видео
- **WMV** — Windows Media Video
- **FLV** — Flash Video
- **WEBM** — WebM видео

### Аудио:
- **MP3** — MPEG Audio Layer 3
- **WAV** — Waveform Audio
- **OGG** — Ogg Vorbis
- **FLAC** — Free Lossless Audio Codec
- **M4A** — MPEG-4 Audio
- **AAC** — Advanced Audio Coding
- **WMA** — Windows Media Audio

## ДЕТАЛЬНЫЕ ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ

### Работа с документами Word:
```json
{
  "action": "list_files",
  "folder": "Docx",
  "description": "Просматриваю DOCX документы"
}

{
  "action": "process_document", 
  "file_path": "important_report.docx",
  "description": "Читаю и анализирую важный отчет"
}
```

### Работа с Excel таблицами:
```json
{
  "action": "list_files",
  "folder": "Excel", 
  "description": "Просматриваю Excel файлы"
}

{
  "action": "process_document",
  "file_path": "sales_data.xlsx",
  "description": "Анализирую данные продаж из Excel"
}
```

### Извлечение текста с изображений:
```json
{
  "action": "list_files",
  "folder": "Photos",
  "description": "Просматриваю изображения"
}

{
  "action": "extract_text",
  "image_path": "scanned_document.jpg",
  "force_ocr": true,
  "description": "Извлекаю текст со сканированного документа"
}
```

### Анализ изображений:
```json
{
  "action": "analyze_image",
  "image_path": "chart.png",
  "check_for_text": true,
  "description": "Анализирую график и извлекаю данные"
}
```

### Создание отчетов:
```json
{
  "action": "generate_file",
  "content": "# Отчет по проекту\\n\\nСодержание отчета...\\n\\n## Выводы\\n\\n1. Первый вывод\\n2. Второй вывод",
  "filename": "project_report.md",
  "file_type": "md",
  "description": "Создаю отчет в формате Markdown"
}

{
  "action": "generate_file",
  "content": "Название отчета\\n\\nДетальное описание\\nС переносами строк\\nИ русским текстом",
  "filename": "simple_report.txt",
  "file_type": "txt", 
  "description": "Создаю простой текстовый отчет"
}
```

## РАБОТА С ВИДЕО

### Покадровый анализ видео:
- Система автоматически извлекает ключевые кадры
- Создает описание каждого кадра с таймкодами
- Форматирует результат как: [Покадровое описание видео]

### Пример анализа видео:
```json
{
  "action": "list_files",
  "folder": "Video",
  "description": "Просматриваю видеофайлы"
}

{
  "action": "process_document",
  "file_path": "presentation.mp4", 
  "description": "Анализирую видео презентацию покадрово"
}
```

### Формат результата видео анализа:
```
[Покадровое описание видео]:
[00:00:00]: Заглавный кадр с логотипом компании
[00:00:05]: Спикер начинает презентацию
[00:01:30]: Показана диаграмма продаж
[00:02:45]: Демонстрация нового продукта
```

## РАБОТА С АУДИО

### Транскрипция аудио:
- Автоматическое распознавание речи
- Создание текста с таймкодами
- Поддержка русского и английского языков

### Пример анализа аудио:
```json
{
  "action": "list_files",
  "folder": "Audio",
  "description": "Просматриваю аудиофайлы"
}

{
  "action": "process_document",
  "file_path": "meeting_record.mp3",
  "description": "Транскрибирую запись совещания"
}
```

### Формат результата аудио анализа:
```
[Текст из аудио]:
[00:00:05] Добро пожаловать на наше совещание
[00:00:15] Сегодня мы обсудим квартальные результаты
[00:01:20] Продажи выросли на двадцать процентов
```

## RAG ОБРАБОТКА БОЛЬШИХ ДОКУМЕНТОВ

### Автоматическое применение RAG:
- Для документов более 10,000 символов
- Разбиение на смысловые блоки
- Векторный поиск по содержанию
- Контекстуальные ответы

### Как работает RAG:
1. Документ разбивается на части
2. Создаются векторные представления
3. По запросу ищутся релевантные части
4. Формируется контекстуальный ответ

## РАЗЛИЧИЕ МЕЖДУ EXTRACT_TEXT И ANALYZE_IMAGE

### extract_text:
- **Назначение**: Принудительное извлечение текста
- **Использование**: Когда нужен именно текст с изображения
- **Триггеры**: "прочитать текст", "извлечь текст", "что написано"
- **Результат**: Только текст без описания изображения

### analyze_image:
- **Назначение**: Общий анализ изображения
- **Использование**: Когда нужно понять содержимое изображения
- **Параметр**: check_for_text=true если подозреваешь наличие текста
- **Результат**: Описание изображения + текст если найден

## СОЗДАНИЕ ФАЙЛОВ

### Поддерживаемые типы для создания:
- **txt** — простой текст
- **md** — Markdown
- **html** — HTML страницы
- **json** — JSON данные с валидацией
- **csv** — CSV таблицы с правильной кодировкой
- **xml** — XML документы с декларацией
- **docx** — Word документы
- **xlsx** — Excel таблицы
- **pdf** — PDF документы

### Примеры создания разных типов:
```json
{
  "action": "generate_file",
  "content": "{\\\"name\\\": \\\"Виталий\\\", \\\"age\\\": 30, \\\"city\\\": \\\"Москва\\\"}",
  "filename": "data.json",
  "file_type": "json",
  "description": "Создаю JSON файл с данными"
}

{
  "action": "generate_file", 
  "content": "Имя,Возраст,Город\\nВиталий,30,Москва\\nАнна,25,СПб",
  "filename": "contacts.csv",
  "file_type": "csv",
  "description": "Создаю CSV таблицу контактов"
}

{
  "action": "generate_file",
  "content": "<!DOCTYPE html>\\n<html>\\n<head><title>Отчет</title></head>\\n<body><h1>Заголовок</h1><p>Содержание отчета</p></body>\\n</html>",
  "filename": "report.html", 
  "file_type": "html",
  "description": "Создаю HTML отчет"
}

{
  "action": "generate_file",
  "content": "<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<data>\\n  <user name=\\\"Виталий\\\" age=\\\"30\\\"/>\\n  <user name=\\\"Анна\\\" age=\\\"25\\\"/>\\n</data>",
  "filename": "users.xml",
  "file_type": "xml", 
  "description": "Создаю XML файл с данными пользователей"
}
```

## ОБРАБОТКА ОШИБОК

### Типичные ошибки:
1. **Файл не найден** — неверный путь или имя файла
2. **Формат не поддерживается** — неизвестный тип файла
3. **OCR не удался** — изображение низкого качества или без текста
4. **Документ поврежден** — файл не читается
5. **Недостаточно места** — нет места для создания файла

### Правильная обработка ошибок:
- **НЕ выдумывай** содержимое файлов при ошибках
- **Честно сообщай** о проблемах пользователю
- **Предлагай решения** (проверить путь, формат и т.д.)
- **Проверяй результаты** операций перед обработкой

## ПРАВИЛА РАБОТЫ С ПУТЯМИ

### Экранирование путей:
- Всегда используй двойные обратные слэши: C:\\\\Users\\\\vital
- Для PowerShell команд экранируй кавычки: \\"path\\"
- Проверяй существование папок перед обработкой

### Относительные пути:
- Аудио: Audio/filename.mp3
- Фото: Photos/image.jpg  
- Видео: Video/movie.mp4
- Документы: Docx/document.docx
- Таблицы: Excel/spreadsheet.xlsx

### Абсолютные пути:
- Рабочий стол: C:\\\\Users\\\\vital\\\\Desktop\\\\
- Полный путь к файлу: C:\\\\Users\\\\vital\\\\Desktop\\\\gG\\\\Photos\\\\image.jpg

## ОПТИМИЗАЦИЯ РАБОТЫ

### Рекомендации:
1. **Сначала list_files** — посмотри что доступно
2. **Проверяй размер** — большие файлы обрабатываются дольше
3. **Используй RAG** — для больших документов автоматически
4. **Группируй операции** — обрабатывай связанные файлы вместе
5. **Сохраняй результаты** — создавай итоговые отчеты

### Примеры оптимизированной работы:
```json
// Сначала обзор
{
  "action": "list_files", 
  "folder": "Excel",
  "description": "Смотрю какие Excel файлы доступны"
}

// Затем обработка
{
  "action": "process_document",
  "file_path": "sales_2024.xlsx", 
  "description": "Анализирую продажи за 2024 год"
}

// В конце создание отчета
{
  "action": "generate_file",
  "content": "Анализ показал рост продаж на 15%...",
  "filename": "sales_analysis.md",
  "file_type": "md",
  "description": "Сохраняю анализ продаж в отчет"
}
```