# МОДУЛЬ: UI АВТОМАТИЗАЦИЯ (UI AUTOMATION)

## Краткое описание
Этот модуль позволяет "видеть" интерфейс Windows-приложений в текстовом виде. Ты можешь находить окна, анализировать их структуру (кнопки, поля ввода, тексты) и взаимодействовать с ними. Это гораздо надежнее, чем просто кликать по координатам, так как ты точно знаешь, что находится в окне.

## Основные возможности
1. **Поиск окна**: Найти нужное приложение по заголовку.
2. **Анализ UI**: Получить дерево элементов окна (кнопки, списки, тексты) в виде структурированного текста.
3. **Взаимодействие**: (В разработке) Клик по элементам по их названию.

## Команды (Actions)

### 1. Получение дерева UI (Inspect UI)
Используй это действие, чтобы "посмотреть" на приложение.

```json
{
  "action": "inspect_ui",
  "window_name": "Заголовок окна (можно часть)",
  "max_depth": 5,
  "description": "Анализирую интерфейс Блокнота"
}
```

**Параметры:**
- `window_name` (обязательно): Заголовок окна или его часть. Если не указано, будет проанализировано активное окно.
- `max_depth` (опционально): Глубина сканирования дерева (по умолчанию 5). Если окно очень сложное, можно уменьшить.

**Результат:**
Ты получишь текстовое представление дерева элементов. Каждый элемент будет иметь:
- Тип (Button, Edit, Text, Window и т.д.)
- Имя (Name)
- Значение (Value) - если есть (например, текст в поле ввода)
- Координаты (Rect)

### Пример ответа системы:
```text
UI Tree for Window: 'Безымянный - Блокнот' (Class: Notepad)
--------------------------------------------------
[Window] Name='Безымянный - Блокнот' Rect=(100, 100, 900, 600)
  [Document] Name='Текстовый редактор' Value='Привет, мир!'
  [MenuBar] Name='Приложение'
    [MenuItem] Name='Файл'
    [MenuItem] Name='Правка'
  [Button] Name='Закрыть'
```

### Стратегия использования
1. Если пользователь просит "прочитать текст из окна X" или "нажать кнопку Y в приложении Z":
   - Сначала используй `inspect_ui` для окна Z.
   - Изучи полученное дерево.
   - Если нужно извлечь текст, найди элемент с нужным `Value` или `Name`.
   - Если нужно кликнуть, используй координаты из `Rect` и команду `left_click` (из модуля управления ПК) или (в будущем) команду клика по имени.

2. Если пользователь просит "найти окно":
   - Используй `inspect_ui` с предполагаемым именем. Если вернется ошибка "Window not found", сообщи об этом.

## Советы
- UI Automation работает только с нативными Windows элементами. Некоторые приложения (например, на Electron или игры) могут не отдавать полную структуру. В таких случаях используй Vision (скриншоты).
- Дерево может быть очень большим. Анализируй только то, что нужно.
